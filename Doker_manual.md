# Doker

## Preview
Doker로 펫 프로젝트 Django앱을 Doker이미지로 생성하여, GCP로 운영,배포

- 로컬개발환경에서 개발이 완료된 이미지를 Doker이미지로 말아서 GCP로 배포할것이다.
- Cloud Run / Compute Engine 중 하나를 선택할수있다. Cloud Run으로 배포해볼 예정이다.
- Djnago+Nginx를 Doker를 통하여 배포

--------

## Doker 이미지와 컨테이너

Docker를 사용하기전, 도커 이미지와 컨테이너, 레이어에 대해 간단하게 리뷰한다.
Docker를 사용하려면 이미지를 생성하는쪽과 이미지를받아 컨테이너를 실행하는쪽 둘다 도커가설치되어있어야한다.


### 도커이미지?

도커 이미지는 '컨테이너 생성' 을 위한 여러 실행파일들을 묶은것.
컨테이너의 생성 및 실행을 위해 모든 파일과 환경값(우분투면 우분투 환경값, 오라클은 오라클 환경값 등)을 묶어놓은것이라고 할수있다.

그래서 이러한 도커이미지파일들은 해당 프로젝트가 운영되던 환경의 실행파일,port등 모두 포함되므로 nnMB~ nnGB로, 꽤 무겁지만 가상머신이미지보단 가벼운편이다.
이미지의 특징으로는

- 하나의 이미지로 여러개의 컨테이너를 생성할수있다.
- 이미지->컨테이너 생성,실행 이므로 컨테이너를 삭제해도 이미지는 남아있는다.
- 도커 이미지들은 Dockerhub를 통해 버전 관리 및 배포가 가능하다.
- 다양한 API제공으로 자동화가 가능하다.
- 이미지는 Dockerfile이라는 파일로 이미지를 만든다. 즉, Dockerfile에는 소스 및 의존성 패키지, 설정파일 등 버전관리가 용이하게 명시되어진다. (누구나 이미지 생성을 확인할수있게됨)
  
### 도커 레이어

레이어는 기존 이미지에 추가적인 파일이 필요할때 해당파일을 추가하기 위한것임.
레이어를 사용하면, 다시 다운로드받지않아도된다.
도커 허브에서 해당 이미지의 레이어만을 배포, 다운로드가 가능하다.

### 도커 컨테이너

'도커 이미지'를 실행한 상태를 말한다. 이미지에 담겨있는 프로젝트/응용프로그램의 종속성과 함께 자체를 캡슐화하며 격리된 공간에서 프로세스를 동작시키는 기술을 말한다.
쉽게말하면 도커 이미지를 실행한것.
도커 컨테이너와 도커 레이어는 서로 연관되어있다.

- 컨테이너는 이미지레이어에 읽기/쓰기로 레이러를 추가하는것으로 생성 및 실행이된다. 여러개의 컨테이너를 생성해도, 최소한의 용량이 사용되는것이다.

- 컨테이너는 종료해도 메모리에남아있으므로, 명시적으로 삭제해줘야한다. 다만 명시적으로 삭제하지않으면 메모리에 그대로 남아있기때문에 다시 시작하기 용이하다.


## 도커 이미지 생성을위한 도커 파일(DockerFile)을 만들어보자

이제 도커 이미지, 즉 도커파일을 만들어보자.

그전에, Docker파일을 만들때 Docker파일의 이미지 이름을 Dockerfile이라고 지으면, build할때 별다른 옵션이 필요하지않다. Docker파일의 이름은 이미지화 시키려는 응용프로그램/프로젝트에따라 다르게 지을수있겠지만, 이름을 다르게 지을시 빌드때 다른옵션이 필요하다.




